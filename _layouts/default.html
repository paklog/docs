<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- SEO Tags -->
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
    <meta name="description" content="{{ page.description | default: site.description }}">
    <meta name="author" content="{{ site.author }}">

    <!-- Open Graph / Social Media Tags -->
    <meta property="og:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}">
    <meta property="og:description" content="{{ page.description | default: site.description }}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ page.url | absolute_url }}">

    <!-- GitHub Pages Theme CSS -->
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">

    <!-- Custom CSS -->
    <style>
      /* Navigation Bar */
      .site-nav {
        background-color: #f5f5f5;
        padding: 1rem 0;
        margin-bottom: 2rem;
        border-bottom: 1px solid #e1e4e8;
      }

      .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
      }

      .nav-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        gap: 2rem;
        flex-wrap: wrap;
      }

      .nav-list li {
        margin: 0;
      }

      .nav-list a {
        color: #0366d6;
        text-decoration: none;
        font-weight: 500;
        padding: 0.5rem 0;
        display: block;
      }

      .nav-list a:hover {
        color: #0056b3;
        text-decoration: underline;
      }

      /* Breadcrumbs */
      .breadcrumbs {
        padding: 0.5rem 0;
        margin-bottom: 1rem;
        font-size: 0.9rem;
        color: #586069;
      }

      .breadcrumbs a {
        color: #0366d6;
        text-decoration: none;
      }

      .breadcrumbs a:hover {
        text-decoration: underline;
      }

      /* Table of Contents */
      .toc {
        background-color: #f6f8fa;
        border: 1px solid #d1d5da;
        border-radius: 6px;
        padding: 1rem;
        margin-bottom: 2rem;
      }

      .toc h2 {
        margin-top: 0;
        font-size: 1.1rem;
        color: #24292e;
      }

      .toc ul {
        margin-bottom: 0;
      }

      .toc li {
        margin: 0.25rem 0;
      }

      /* Main Content Styling */
      .main-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
      }

      .main-content h1 {
        border-bottom: 1px solid #e1e4e8;
        padding-bottom: 0.5rem;
        margin-bottom: 1.5rem;
      }

      .main-content h2 {
        margin-top: 2rem;
        border-bottom: 1px solid #e1e4e8;
        padding-bottom: 0.3rem;
      }

      .main-content h3 {
        margin-top: 1.5rem;
      }

      /* Code blocks */
      .main-content pre {
        background-color: #f6f8fa;
        border: 1px solid #d1d5da;
        border-radius: 6px;
        padding: 1rem;
        overflow-x: auto;
      }

      .main-content code {
        background-color: rgba(27,31,35,0.05);
        padding: 0.2em 0.4em;
        border-radius: 3px;
        font-size: 85%;
      }

      .main-content pre code {
        background-color: transparent;
        padding: 0;
      }

      /* Tables */
      .main-content table {
        border-collapse: collapse;
        width: 100%;
        margin: 1rem 0;
      }

      .main-content th,
      .main-content td {
        border: 1px solid #d1d5da;
        padding: 0.5rem;
        text-align: left;
      }

      .main-content th {
        background-color: #f6f8fa;
        font-weight: 600;
      }

      .main-content tr:nth-child(even) {
        background-color: #f6f8fa;
      }

      /* Footer */
      .site-footer {
        margin-top: 4rem;
        padding: 2rem 0;
        border-top: 1px solid #e1e4e8;
        background-color: #f5f5f5;
        text-align: center;
        color: #586069;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .nav-list {
          flex-direction: column;
          gap: 0.5rem;
        }

        .main-content {
          padding: 0 1rem;
        }
      }

      /* Print Styles */
      @media print {
        .site-nav,
        .breadcrumbs,
        .toc,
        .site-footer {
          display: none;
        }
      }
    </style>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ "/favicon.ico" | relative_url }}">

    <!-- Google Analytics (if configured) -->
    {% if site.google_analytics %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{{ site.google_analytics }}');
    </script>
    {% endif %}
  </head>
  <body>
    <!-- Navigation -->
    <nav class="site-nav">
      <div class="nav-container">
        <ul class="nav-list">
          <li><a href="{{ "/" | relative_url }}">üè† Home</a></li>
          <li><a href="{{ "/diagrams/" | relative_url }}">üìê Architecture</a></li>
          <li><a href="{{ "/business-capababilities/" | relative_url }}">üíº Business</a></li>
          <li><a href="{{ "/domain-driven-design/" | relative_url }}">üéØ DDD</a></li>
          <li><a href="{{ "/decoupling_wes_wms" | relative_url }}">üîÑ Decoupling</a></li>
          <li><a href="{{ "/detailed_plan" | relative_url }}">üìã Implementation</a></li>
          {% if site.show_repository %}
          <li><a href="{{ site.github.repository_url }}" target="_blank">üì¶ GitHub</a></li>
          {% endif %}
        </ul>
      </div>
    </nav>

    <!-- Breadcrumbs -->
    {% if page.url != "/" %}
    <div class="main-content">
      <div class="breadcrumbs">
        <a href="{{ "/" | relative_url }}">Home</a>
        {% assign crumbs = page.url | split: '/' %}
        {% assign crumb_path = '' %}
        {% for crumb in crumbs %}
          {% if crumb != "" and crumb != "index.html" %}
            {% assign crumb_path = crumb_path | append: '/' | append: crumb %}
            / <a href="{{ crumb_path | relative_url }}">{{ crumb | replace: '-', ' ' | capitalize }}</a>
          {% endif %}
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <!-- Main Content -->
    <main class="main-content">
      {{ content }}
    </main>

    <!-- Footer -->
    <footer class="site-footer">
      <div class="nav-container">
        <p><strong>{{ site.title }}</strong></p>
        <p>{{ site.description }}</p>
        <p>
          {% if site.github.is_project_page %}
          <a href="{{ site.github.repository_url }}">View on GitHub</a> |
          {% endif %}
          <a href="#top">Back to Top</a>
        </p>
        <p><small>Last updated: {{ site.time | date: '%B %d, %Y' }}</small></p>
      </div>
    </footer>

    <!-- Include Mermaid.js Support -->
    {% include mermaid.html %}

    <!-- Custom JavaScript -->
    <script>
      // Add smooth scrolling
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth'
            });
          }
        });
      });

      // Add copy button to code blocks
      document.addEventListener('DOMContentLoaded', function() {
        const codeBlocks = document.querySelectorAll('pre');

        codeBlocks.forEach(function(codeBlock) {
          const button = document.createElement('button');
          button.className = 'copy-button';
          button.textContent = 'Copy';
          button.style.cssText = 'position: absolute; top: 5px; right: 5px; padding: 5px 10px; background: #0366d6; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 12px;';

          // Make parent relative for absolute positioning
          codeBlock.style.position = 'relative';

          button.addEventListener('click', function() {
            const code = codeBlock.querySelector('code');
            const text = code ? code.textContent : codeBlock.textContent;

            navigator.clipboard.writeText(text).then(function() {
              button.textContent = 'Copied!';
              setTimeout(function() {
                button.textContent = 'Copy';
              }, 2000);
            });
          });

          codeBlock.appendChild(button);
        });
      });
    </script>
  </body>
</html>